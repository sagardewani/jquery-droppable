/* ========================================================================
 * Dset: jQuery.droppable.min.js v1.0.0
 * ========================================================================
 * Copyright 2017 Hetrotech Private Limited.
 * Licensed under MIT
 * ======================================================================== */
!function(e,t){"use strict";function s(e){new l(e)}function n(e,t,s){i(e,this.$selected.element,t,s)}function i(e,t,s,n){if(e)if(n.set){var i=n.size,o=n.origin,d=n.repeat,r=n.position;t.css("background-image",'url("'+e+'")'),t.css("background-origin",o),t.css("background-position",r),t.css("background-repeat",d),t.css("background-size",i)}else if(s){var a=new Image;a.onload=function(){a.className="drop-img",t.append(a)},a.src=e}else"IMG"==t.prop("tagName")?t.attr("src",e):t.html('<img class="drop-img" src='+e+" />")}function o(e,s,n,i){if(t.Promise)return new Promise(function(t,o){var d,r=i||5e3,a=new Image;a.onerror=a.onabort=function(){clearTimeout(d),o(Error("Image URL is not retrievable\n Please drop image with actual URL(might not in encoded form)"))},a.onload=function(){if(clearTimeout(d),n){var e,i,r,l;e=s.maxDimensions.height,i=s.maxDimensions.width,r=s.minDimensions.height,a.width>i||a.width<l?o(Error("The image dimensions doesn't match the specified criteria of\n Max Width: "+i+"px or Min Width: "+l+"px")):a.height>e||a.height<r?o(Error("The image dimensions doesn't match the specified criteria of\n Max Height: "+e+"px or Min Height: "+r+"px")):t("success")}else t("success")},d=setTimeout(function(){a.src="//!!!!/test.jpg",o("timeout")},r),a.src=e});throw new Error("Please upgrade your browser\n This doesn't support the Promises.")}function d(e){var t=[],s=this,i=(s.keys.maxSize,s.keys.dimensions),d=s.keys.customDimensions,r=s.keys.background;s.$selected.element;e.originalEvent.dataTransfer&&(t=e.originalEvent.dataTransfer.items);for(var a=0;1>a;a++)t[a].getAsString(function(e){o(e,i,d).then(function(t){"success"==t&&n.call(s,e,d,r)})["catch"](function(e){console.log(e)})})}function r(){0==e.fn.settings.modalCreated&&a()}function a(){var t='<div id="source-container" class="modal fade d-set" role="dialog">		  <div class="modal-dialog d-set">			<div class="modal-content d-set">			  <div class="modal-header d-set">				<button type="button" class="close d-set" data-dismiss="modal">&times;</button>				<h4 class="modal-title d-set">CSS Styles</h4>			  </div>			  <div class="modal-body d-set">				<pre class="d-set"></pre>			  </div>			  <div class="modal-footer d-set">				<button type="button" class="btn btn-default d-set" data-dismiss="modal">Close</button>			  </div>			</div>		</div>		</div>';e("body").append(t),e.fn.settings.modalCreated=1}var l=function(s){r(),this.keys=e.extend({},e.fn.droppable.defaults,s),this.droppableObject,this.previous,this.$selected={element:"undefined",drop:"undefined",dragLeave:"undefined",dragOver:"undefined",dropActive:"undefined",tagName:"undefined"},e(t).on("click",e.proxy(this.onDropSelect,this)).off("keydown",e.fn.settings.onKeyDown).on("keydown",e.proxy(e.fn.settings.onKeyDown,this)).on("keydown",e.proxy(e.fn.settings.onDropKeyDown,this)),e.fn.settings.commands.common(),e.fn.settings.commands.drop()};l.VERSION="1.0.0",l.pluginName="DROPPABLE",l.AUTHOR="Sagar Dewani",l.WEBSITE="http://www.hetrotech.in/",e.fn.droppable=function(e){return s(e)},t.$.droppable=e.fn.droppable;var c={disableSelect:[e("body"),e("#wrapper"),e("html"),e("option")],defSetting:{droppable:0},modalCreated:0,commands:{common:function(){var t,s,n=["alt+shift+ctrl","ctrl+m","ENTER"],i=["to go back to normal mode","to check which mode is active","to view the source generated"];for(t=0;t<n.length;t++)s="<li class='d-set'><pre class='d-set'><code class='d-set'><i class='d-set'>"+n[t]+"</i> : "+i[t]+"</code></pre></li>",e("#cmdList").append(s)},drop:function(){var t,s,n=["shift+i"],i=["to (de)activate droppable mode"];for(t=0;t<n.length;t++)s="<li class='d-set'><pre class='d-set'><code class='d-set'><i class='d-set'>"+n[t]+"</i> : "+i[t]+"</code></pre></li>",e("#cmdList").append(s)}},onKeyDown:function(t){var s=this;if("undefined"!==s.$selected.element){if(t.shiftKey&&t.ctrlKey&&t.altKey)for(var n in e.fn.settings.defSetting)e.fn.settings.defSetting.hasOwnProperty(n)&&(e.fn.settings.defSetting[n]=0);if(t.ctrlKey&&t.which==s.keys.modeKey){var i="normal";for(var n in e.fn.settings.defSetting)e.fn.settings.defSetting.hasOwnProperty(n)&&1==e.fn.settings.defSetting[n]&&(i=n);alert("Activated Mode: "+i)}if(t.which==s.keys.sourceKey)if(e.fn.settings.defSetting.transition){e(".modal-body>pre").empty();var o,d,r=e("style#d-set-stylesheet")[0].sheet?e("style#d-set-stylesheet")[0].sheet:e("style#d-set-stylesheet")[0].styleSheet,a=r.rules?r.rules:r.cssRules,l=a.length?a.length:a.length,c=s.$selected.element.attr("class").split(" ");for(o=0;l>o;o++)d=a[o].selectorText.replace(".",""),c.indexOf(d)>-1?e(".modal-body>pre").append("<code class=d-set style='background-color:#7fdfde;'>"+a[o].cssText+"</code><br/>"):e(".modal-body>pre").append("<code class=d-set>"+a[o].cssText+"</code><br/>");e("#source-container").modal("show")}else(e.fn.settings.defSetting.colorify||e.fn.settings.defSetting.reposizing)&&(e(".modal-body>pre").empty(),e(".modal-body>pre").append("<code class=d-set>"+s.$selected.element.attr("style")+"</code><br/>"),e("#source-container").modal("show"))}t.altKey&&"72"==t.which&&e("#cmdListContainer").toggleClass("hide")},onDropKeyDown:function(t){var s=this;if("undefined"!==s.$selected.element){if(t.shiftKey&&t.which==s.keys.droppableKey){for(var n in e.fn.settings.defSetting)e.fn.settings.defSetting.hasOwnProperty(n)&&e.fn.settings.defSetting.droppable||(e.fn.settings.defSetting[n]=0);e.fn.settings.defSetting.droppable=0==e.fn.settings.defSetting.droppable?1:0}if(t.which==s.keys.sourceKey&&e.fn.settings.defSetting.droppable){e(".modal-body>pre").empty();var i;s.keys.background.set?(i="{",i+=s.$selected.element.attr("style"),i+="}"):i="Add these elements   &ltimg class='drop-img' src='your-img-path' /&gt",e(".modal-body>pre").append("<code class=d-set>"+i+"</code><br/>"),e("#source-container").modal("show")}}}};e.fn.settings=e.extend(!0,{},e.fn.settings||{},c),e.fn.droppable.defaults={droppableKey:"73",sourceKey:"13",modeKey:"77",dimensions:{maxDimensions:{width:1920,height:1080},minDimensions:{width:1,height:1}},customDimensions:!0,background:{set:!1,position:"initial",size:"cover",repeat:"no-repeat",origin:"content-box"}},l.prototype.onDropSelect=function(t){function s(){var t,s=this.$selected.element;return s.off("dragover").on("dragover",function(s){s.preventDefault(),s.stopPropagation(),t=e.fn.settings.defSetting.droppable,t&&e(this).addClass("dragOver")})}function n(){var t,s=this.$selected.element;return s.off("dragleave").on("dragleave",function(s){s.preventDefault(),s.stopPropagation(),t=e.fn.settings.defSetting.droppable,t&&e(this).removeClass("dragOver")})}function i(){var t,s=this,n=this.$selected.element;return n.off("drop").on("drop",function(n){n.preventDefault(),n.stopPropagation(),t=e.fn.settings.defSetting.droppable,t&&(e(this).removeClass("dragOver"),d.call(s,n))})}var o,r=this,a=e.fn.settings.disableSelect,l=a.length;for(o=0;l>o;o++)if(e(t.target).is(a[o]))return;e(t.target).is('[class*="d-set"]')||(r.$selected.element=e(t.target),r.$selected.dragOver="undefined"!=r.$selected.element?s.call(r):"undefined",r.$selected.dragLeave="undefined"!=r.$selected.element?n.call(r):"undefined",r.$selected.drop="undefined"!=r.$selected.element?i.call(r):"undefined",r.$selected.tagName="undefined"!=r.$selected.element?r.$selected.element[0].tagName.toLowerCase():"undefined",r.$selected.dropActive="undefined"!=r.$selected.element?e.fn.settings.defSetting.droppable:"undefined",r.$selected.element&&(r.previous&&r.previous.hasClass("border-blue")&&r.previous.removeClass("border-blue"),r.previous=r.$selected.element,r.previous.addClass("border-blue")))}}(jQuery,window);